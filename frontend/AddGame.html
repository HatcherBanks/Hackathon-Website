<!DOCTYPE html>
<html>
    <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body {font-family: Aptos;}
        form {border: 10px solid #f1f1f1;}
        
        input[type=text] {
          width: 100%;
          padding: 14px 20px;
          margin: 9px 0;
          display: inline-block;
          border: 1px solid #cccccc;
          box-sizing: border-box;
        }
        
        button {
          background-color: #040aaa;
          color: white;
          padding: 14px 20px;
          margin: 8px 0;
          border: none;
          cursor: pointer;
          width: 100%;
        }
        
        .cancelbtn {
          width: auto;
          padding: 10px 18px;
          background-color: #f44336;
        }
        
        .imgcontainer {
          text-align: center;
          margin: 24px 0 12px 0;
          width: 500px;
          height: 500px;
        }
        
        .container {
          padding: 16px;
        }
        
        span.psw {
          float: right;
          padding-top: 16px;
        }
        
        @media screen and (max-width: 300px) {
          span.psw {
             display: block;
             float: none;
          }
          .cancelbtn {
             width: 100%;
          }
        }
        </style>
    </head>
    <body>
        <h3> Add a new game here </h3>
        <form id="gameForm" method="post"></form>
          <div class = "container">
            <label for="image">Upload Image:</label>
            <input type="file" id="image" name="image" accept="image/*" required>
            <br>
            <label>
                <b> Title </b>
            </label>
            <input id="title" type="text" placeholder="Title" required> 

            <label>
                <b> Description </b>
            </label>
            <input id="description" type="text" placeholder="Description" required>

            <label>
                <b> Price </b>
            </label>
            <input id="price" type="text" placeholder="Price" required>

            <label for="Genre"> <label> <b> Genre </b></label> <br> </label>
            <select id="Genre" name="Genre">
               <option value="Horror">Horror</option>
               <option value="Action">Action</option>
               <option value="Adventure">Adventure</option>
               <option value="RPG">RPG</option>
               <option value="Strategy">Strategy</option>
               <option value="Simulation">Simulation</option>
               <option value="Sport">Sport</option>
               <option value="Puzzle">Puzzle</option>
            </select>
            
            <br>
            <br>
            <br>
            <label for="Type"><label> <b> Type </b></label> <br> </label>
            <select id="Type" name="Type">
               <option value="TwoD">2D</option>
               <option value="ThreeD">3D</option>
               <option value="VR">VR</option>
               <option value="AR">AR</option>
               <option value="TextBased">TextBased</option>
            </select>

            <br>
            <button type="submit"> Submit </button>
          </div>
        </form>

        <div class="container" style="background-color:#f1f1f1">
          <a href="index.html"> <button type="button" class="cancelbtn">Cancel</button> </a>
        </div>

      <script>
        const BASE_URL = 'http://localhost:8080';
        document.getElementById('gameForm').addEventListener('submit', function(event) {
          event.preventDefault();

          const fileInput = document.getElementById('image');
          const title = document.getElementById('email').value;
          const description = document.getElementById('description').value;
          const price = document.getElementById('price').value;
          const genre = document.getElementById('Genre').value;
          const type = document.getElementById('Type').value;
          const file = fileInput.files[0];

          console.log("enterd handle");
          console.log(file);
          if (file) {
              const reader = new FileReader();
              reader.onloadend = function() {
                  const base64Image = reader.result.split(',')[1]; // Getting the base64 part of the data URL

                  const jsonObject = {
                      image: base64Image,
                      title: title,
                      description: description,
                      price: price,
                      genre: genre,
                      type: type
                  };

                  fetch(BASE_URL + "/game", {
                      method: 'POST',
                      headers: {
                          'Content-Type': 'application/json',
                      },
                      body: JSON.stringify(jsonObject)
                  })
                  .then(response => response.json())
                  .then(data => {
                      console.log('Success:', data);
                      // Handle the response data
                  })
                  .catch(error => {
                      console.error('Error:', error);
                  });
              };
              reader.readAsDataURL(file); // Convert file to base64 string
          } else {
              console.error('No file selected.');
          }
        });
      </script>  
    </body>
</html>